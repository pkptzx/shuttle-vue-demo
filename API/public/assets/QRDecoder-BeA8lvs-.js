import"//cdn.staticfile.net/sweetalert2/11.7.2/sweetalert2.all.min.js";import{h as v,a as u,e as h,n as b,j as d,k as t,p as y,F as m,q as w,m as f,l as x}from"./index-6HomX-Dx.js";const _={class:"card card-compact w-96 bg-base-100 shadow-xl"},k={class:"card-body"},B={class:"card-actions justify-end"},E=["disabled"],D=v({__name:"QRDecoder",setup(L){let r;const i=u(),n=u([]),a=u(!1);h(async()=>{i.value.focus(),document.body.addEventListener("paste",c)}),b(async()=>{document.body.removeEventListener("paste",c)});function c(s){var p;const e=(p=s.clipboardData)==null?void 0:p.items;if(r=null,!e||e.length===0){console.error("当前浏览器不支持本地"),Sweetalert2.fire({title:"Error!",text:"当前浏览器不支持本地",icon:"error",confirmButtonText:"好"});return}for(let o=0;o<e.length;o++)if(e[o].type.indexOf("image")!==-1){r=e[o].getAsFile();break}if(!r){Sweetalert2.fire({title:"Error!",text:"粘贴内容非图片",icon:"error",confirmButtonText:"好"}),console.error("粘贴内容非图片");return}const l=new FileReader;l.onload=o=>{console.log("event",o),i.value.innerHTML=`<img style="height: 300px;" src="${o.currentTarget.result}">`},l.readAsDataURL(r),console.log(r)}function g(){if(!r){console.error("请粘贴图片后上传"),Sweetalert2.fire({title:"Error!",text:"请粘贴图片后上传",icon:"error",confirmButtonText:"好"});return}n.value=[],a.value=!0;const s=new FormData;s.append("file",r),fetch("/upload",{method:"POST",body:s}).then(e=>{if(a.value=!1,e.ok)return console.log("success"),e.json();Sweetalert2.fire({title:"Error!",text:"服务端异常,请稍后重试",icon:"error",confirmButtonText:"好"}),console.log("error")}).then(e=>{console.log("res is",e),e.result_origin?(n.value.push(`二维码内容1: ${e.result_origin}`),n.value.push(`二维码内容2: ${e.result}`)):n.value.push(`二维码内容: ${e.result}`)})}return(s,e)=>(f(),d(m,null,[t("div",_,[t("figure",{ref_key:"preview",ref:i,onPaste:c},e[0]||(e[0]=[t("div",{class:"grid w-96 h-96 bg-base-300 place-items-center"},"将图片按Ctrl+V 粘贴至此处",-1)]),544),t("div",k,[e[1]||(e[1]=t("h2",{class:"card-title"},"解析二维码",-1)),e[2]||(e[2]=t("p",null,"如果二维码中是一个URL那么将会返回请求URL后的结果",-1)),t("div",B,[t("button",{class:y(["btn btn-primary",{loading:a.value}]),disabled:a.value,onClick:g},"上传并解析",10,E)])])]),(f(!0),d(m,null,w(n.value,l=>(f(),d("div",{key:l,style:{"overflow-wrap":"anywhere"}},x(l),1))),128))],64))}});export{D as default};
